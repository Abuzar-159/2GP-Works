<apex:page controller="ShowSlipsController" sidebar="false" showHeader="true">
    <h1>Picking + Packing Slips</h1>
    <button onclick="window.print()">Print All</button>
    <hr/>

    <apex:repeat value="{!data}" var="log">

        <h2>Logistics: {!log.logId}</h2>
        <hr/>

        <!-- PICKING SLIP (ONCE per Logistics) -->
        <h3>Picking Slip</h3>
        <iframe src="/apex/PickSlip?loIds={!log.logId}"
                width="100%" height="800px" frameborder="0"></iframe>

        <hr/>

        <!-- PACKING SLIP (per Package) -->
        <apex:repeat value="{!log.packages}" var="pkg">
            <h3>Package: {!pkg.Name}</h3>

            <h4>Packing Slip</h4>
            <iframe src="/apex/PackSlip?pkIds={!pkg.Id}"
                    width="100%" height="800px" frameborder="0"></iframe>

            <hr/>
        </apex:repeat>

        <!-- BOL + LABELS (per Shipment, ONCE per Logistics section) -->
         <!-- <apex:repeat value="{!log.shipments}" var="sh">
            <h3>Shipment: {!sh.shipmentName}</h3>

            <h4>BOL (PDF)</h4>
            <apex:repeat value="{!sh.bolPdfs}" var="f">
                <div style="margin-bottom:12px;">
                    <div><b>{!f.title}</b></div>
                    <iframe src="{!f.inlineUrl}"
                            width="100%" height="800px" frameborder="0"></iframe>
                </div>
            </apex:repeat>

            <h4>Labels (PDF)</h4>
            <apex:repeat value="{!sh.labelPdfs}" var="f2">
                <div style="margin-bottom:12px;">
                    <div><b>{!f2.title}</b></div>
                    <iframe src="{!f2.inlineUrl}"
                            width="100%" height="800px" frameborder="0"></iframe>
                </div>
            </apex:repeat>

            <hr/>
        </apex:repeat>  -->

        <apex:repeat value="{!log.shipments}" var="sh">
    <h3>Shipment: {!sh.shipmentName}</h3>

    <h4>BOL</h4>
    <apex:repeat value="{!sh.bolPdfs}" var="f">
        <div style="margin-bottom:10px; padding:8px; border:1px solid #ddd;">
            <div style="font-weight:600;">{!f.title}</div>

            <apex:outputPanel rendered="{!NOT(ISBLANK(f.previewUrl))}">
                <apex:outputLink value="{!f.previewUrl}" target="_blank">Preview</apex:outputLink>
                &nbsp;|&nbsp;
                <apex:outputLink value="{!f.openUrl}" target="_blank">Download</apex:outputLink>
            </apex:outputPanel>

            <apex:outputPanel rendered="{!ISBLANK(f.previewUrl)}">
                <apex:outputLink value="{!f.openUrl}" target="_blank">Download</apex:outputLink>
            </apex:outputPanel>
        </div>
    </apex:repeat>

    <h4>Labels</h4>
    <apex:repeat value="{!sh.labelPdfs}" var="f2">
        <div style="margin-bottom:10px; padding:8px; border:1px solid #ddd;">
            <div style="font-weight:600;">{!f2.title}</div>

            <apex:outputPanel rendered="{!NOT(ISBLANK(f2.previewUrl))}">
                <apex:outputLink value="{!f2.previewUrl}" target="_blank">Preview</apex:outputLink>
                &nbsp;|&nbsp;
                <apex:outputLink value="{!f2.openUrl}" target="_blank">Download</apex:outputLink>
            </apex:outputPanel>

            <apex:outputPanel rendered="{!ISBLANK(f2.previewUrl)}">
                <apex:outputLink value="{!f2.openUrl}" target="_blank">Download</apex:outputLink>
            </apex:outputPanel>
        </div>
    </apex:repeat>

    <hr/>
</apex:repeat>


    </apex:repeat>
</apex:page>
